<ion-view title="New Object">
  <ion-content scrollbar-y="false" class="has-header">

    <md-input-container class="md-block padding">
      <md-select placeholder="Select template" ng-change="changeTemplateOfNewObject(chosenTemplate)" ng-model="chosenTemplate">
        <md-option ng-repeat="template in templates" value="{{template}}">{{template.name}}</md-option>
      </md-select>
    </md-input-container>

    <!--<label class="item item-select">-->
      <!--<span class="input-label">Select Template</span>-->
      <!--<select ng-model="chosenTemplate" ng-change="changeTemplateOfNewObject(chosenTemplate)"-->
              <!--ng-options="template as template.name for template in templates"></select>-->
    <!--</label>-->

    <form name="objectForm">
      <div ng-init="setForm(objectForm)"></div>

      <!--<label class="item item-input ">-->
        <!--<span class="input-label"><strong>Name </strong><span class="red">*</span></span>-->
        <!--<input required="required" name="objectName" type="text" ng-model="template.name" value="{{template.name}}">-->
      <!--</label>-->

      <!--<div class="red text-center" ng-show="objectForm.objectName.$dirty && objectForm.objectName.$error.required">Name-->
        <!--is required!-->
      <!--</div>-->


      <md-input-container  class="md-block">
        <label >
          <span class="md-title"><b>Name</b></span>
          <span class="red">*</span>
        </label>

          <input name="newObjectName1"
                 required = "required"
                 value="{{tem.value}}"
                 ng-model="template.name">
          <div ng-messages="objectForm.newObjectName1.$error" multiple md-auto-hide="true">
            <div ng-message="required">
              This field is required!
            </div>
          </div>
      </md-input-container>

      <div  ng-repeat="tem in template" ng-class-even="'even-list'">
        <!--If attr type is text-->

        <div class="object-list" style="padding-bottom:0" ng-if="tem.type === 'text' || tem.type === 'paragraph' || tem.type === 'link' || tem.type === 'number'" layout="column" layout-align="center none">

          <md-input-container  class="md-block">
            <label >
              <span class="md-title"><b>{{tem.key}}</b></span>
              <span class="red" ng-if="tem.required">*</span>
            </label>
            <div ng-switch="tem.type">
              <input ng-switch-when="link"
                     name="{{tem.key}}"
                     ng-required="tem.required"
                     value="{{tem.value}}"
                     ng-model="tem.value"
                     ng-pattern="/^(www|http:\/\/|https:\/\/)/i">

              <input ng-switch-when="number"
                     name="{{tem.key}}"
                     ng-required="tem.required"
                     value="{{tem.value}}"
                     ng-model="tem.value"
                     ng-pattern="/^(\d+)((\.?)(\d+))?$/"/>

              <input ng-switch-default
                     name="{{tem.key}}"
                     ng-required="tem.required"
                     value="{{tem.value}}"
                     ng-model="tem.value"/>
            </div>
            <div ng-messages="objectForm[tem.key].$error" multiple md-auto-hide="true">
              <div ng-message="required">
                This field is required!
              </div>
              <div ng-message="pattern">
                This is not a {{tem.type}}!
              </div>
            </div>
          </md-input-container>
        </div>

        <!--If attr type is file-->
        <div class="object-list" ng-if="tem.type === 'file'" >
          <label> <span class="md-subhead"><b>{{tem.key}}</b></span><span class="red" ng-if="tem.required">*</span></label>
          <div layout="row" layout-align="space-between">
            <span></span>
            <!--Required error message-->
            <!--<div class="red text-center" ng-show="objectForm[tem.key].$error.required">-->
              <!--<div class="spacer" style="width: 283px; height: 15px;"></div>-->
              <!--This field is required!-->
            <!--</div>-->
            <!--<input type="hidden" ng-model="dauConMum" name="{{tem.key}}" ng-required="tem.required && !tem.file">-->


            <!--If file is not uploaded-->
            <div ng-if="!tem.file">
              <span layout="column" layout-align="center center" style="height:60px">
                <div flex class="material-icons" style="font-size:40px; color:lightgray"> description</div>

                <p><strong>No file uploaded.</strong></p>
              </span>
            </div>
            <!--If file is uploaded-->
            <div ng-if="tem.file">

              <div class="wrapper"
                   ng-show="(fileType.imageType.indexOf(tem.file.url.substr(tem.file.url.lastIndexOf('.') + 1)) > -1)"
                   style='background-image: url({{tem.file.url.replace(" ", "%20")}});'>
              </div>

              <div ng-show="!(fileType.imageType.indexOf(tem.file.url.substr(tem.file.url.lastIndexOf('.') + 1)) > -1)">
                  <span layout="column" layout-align="center center" style="height:60px">
                  <!--<div class="column " >-->
                    <div flex class="material-icons" style="font-size:40px; color:orange"> description</div>

                    <p>File Type: <strong>{{tem.file.url.substr(tem.file.url.lastIndexOf('.') + 1)}}</strong></p>
                  </span>
              </div>

            </div>
            <div layout="column" layout-align="center">
              <md-button class="md-icon-button" ng-click="showActionSheet($index)">
                <md-icon class="material-icons">mode_edit</md-icon>
              </md-button>
            </div>

          </div>

          <!--<md-divider ng-if="!$last"></md-divider>-->
        </div>

        <!--If attr type is relationship-->
        <div class="object-list" ng-if="tem.type === 'relationship'">
          <label> <span class="md-subhead"><b>{{tem.key}}</b></span>
            <span class="red" ng-if="tem.required">*</span></label>

          <!--Required error message-->
          <!--<div class="red text-center" ng-show="objectForm[tem.key].$error.required">-->
            <!--<div class="spacer" style="width: 283px; height: 15px;"></div>-->
            <!--This field is required!-->
          <!--</div>-->
          <!--<input type="hidden" name="{{tem.key}}" ng-model="dauConMum" ng-required="tem.required && !tem.value">-->
          <!--icon-->

          <div layout="row" layout-align="space-between">
            <span></span>

            <!--If no relationship is set-->
            <div>
              <div class="spacer" style="width: 283px; height: 5px;"></div>
              <div class="row">
                <div class="col text-center">
                  <strong ng-show="!tem.relationship">No relationships are set</strong>
                  <strong ng-show="tem.relationship">{{tem.relationship[0] + " object(s) of type " + tem.relationship[1]}}</strong>
                </div>
              </div>
            </div>

            <div layout="column" layout-align="center">
              <md-button class="md-icon-button" ng-click="addRelationship(tem)">
                <md-icon class="material-icons">mode_edit</md-icon>
              </md-button>
            </div>
          </div>
        </div>
      </div>

      <!--<div class="item item-input item-stacked-label" ng-repeat="tem in template" ng-class-even="'even-list'">-->
        <!--<strong>{{tem.key}}</strong>-->
        <!--<span ng-if="tem.required" class="red">*</span>-->

        <!--&lt;!&ndash;If attr type is text/number/link&ndash;&gt;-->
        <!--<div ng-if="tem.type === 'text' || tem.type === 'paragraph' || tem.type === 'link' || tem.type === 'number'">-->
          <!--&lt;!&ndash;validation error message&ndash;&gt;-->
          <!--<div class="red text-center" ng-show="objectForm[tem.key].$error.pattern">-->
            <!--<div class="spacer" style="width: 283px; height: 15px;"></div>-->
            <!--This is not a {{tem.type}}!-->
          <!--</div>-->

          <!--&lt;!&ndash;Required error message&ndash;&gt;-->
          <!--<div class="red text-center" ng-show="objectForm[tem.key].$error.required && objectForm[tem.key].$dirty">-->
            <!--<div class="spacer" style="width: 283px; height: 15px;"></div>-->
            <!--This field is required!-->
          <!--</div>-->

          <!--&lt;!&ndash;prop value field&ndash;&gt;-->
          <!--<div ng-switch="tem.type">-->
            <!--<i class="icon placeholder-icon ion-ios-paper-outline"-->
               <!--ng-if="tem.type === 'text' || tem.type === 'paragraph' || tem.type === 'link' || tem.type === 'number'"></i>-->

            <!--<input ng-switch-when="link"-->
                   <!--name="{{tem.key}}"-->
                   <!--ng-required="tem.required"-->
                   <!--value="{{tem.value}}"-->
                   <!--placeholder="Enter value"-->
                   <!--ng-model="tem.value"-->
                   <!--ng-pattern="/^(www|http:\/\/|https:\/\/)/i"/>-->

            <!--<input ng-switch-when="number"-->
                   <!--name="{{tem.key}}"-->
                   <!--ng-required="tem.required"-->
                   <!--value="{{tem.value}}"-->
                   <!--placeholder="Enter value"-->
                   <!--ng-model="tem.value"-->
                   <!--ng-pattern="/^(\d+)((\.?)(\d+))?$/"/>-->

            <!--<input ng-switch-default-->
                   <!--name="{{tem.key}}"-->
                   <!--ng-required="tem.required"-->
                   <!--value="{{tem.value}}"-->
                   <!--placeholder="Enter value"-->
                   <!--ng-model="tem.value"/>-->
          <!--</div>-->
        <!--</div>-->

        <!--If attr type is file-->
        <!--<div ng-if="tem.type === 'file'">-->
          <!--&lt;!&ndash;Required error message&ndash;&gt;-->
          <!--<div class="red text-center" ng-show="objectForm[tem.key].$error.required">-->
            <!--<div class="spacer" style="width: 283px; height: 15px;"></div>-->
            <!--This field is required!-->
          <!--</div>-->
          <!--<input type="hidden" name="{{tem.key}}" ng-model="dauConMum" ng-required="tem.required && !tem.file">-->

          <!--&lt;!&ndash;If file is not uploaded&ndash;&gt;-->
          <!--&lt;!&ndash;<p ng-if="!tem.file">No file uploaded.</p>&ndash;&gt;-->

          <!--&lt;!&ndash;If file is uploaded&ndash;&gt;-->
          <!--<div ng-if="tem.file">-->
            <!--<div class="wrapper"-->
                 <!--ng-show="(fileType.imageType.indexOf(tem.file.url.substr(tem.file.url.lastIndexOf('.') + 1)) > -1)"-->
                 <!--style='background-image: url({{tem.file.url.replace(" ", "%20")}});'>-->
            <!--</div>-->

            <!--<div ng-show="!(fileType.imageType.indexOf(tem.file.url.substr(tem.file.url.lastIndexOf('.') + 1)) > -1)">-->
              <!--<div class="center-image">-->
                <!--<img src="img/file-icon.png">-->
              <!--</div>-->
              <!--<strong>File type: {{tem.file.url.substr(tem.file.url.lastIndexOf('.'))}}</strong>-->
            <!--</div>-->
          <!--</div>-->

          <!--<div class="row">-->
            <!--<button type="button" ng-click="browseFile($index)"-->
                    <!--class="button icon-left ion-folder button-clear button-royal col-50">-->
              <!--Upload file-->
            <!--</button>-->
            <!--<button type="button" ng-click="takePicture($index)"-->
                    <!--class="button icon-left ion-camera button-clear button-royal col-50">-->
              <!--Take picture-->
            <!--</button>-->
          <!--</div>-->
        <!--</div>-->

        <!--&lt;!&ndash;If attr type is relationship&ndash;&gt;-->
        <!--<div ng-if="tem.type === 'relationship'">-->
          <!--&lt;!&ndash;Required error message&ndash;&gt;-->
          <!--<div class="red text-center" ng-show="objectForm[tem.key].$error.required">-->
            <!--<div class="spacer" style="width: 283px; height: 15px;"></div>-->
            <!--This field is required!-->
          <!--</div>-->
          <!--<input type="hidden" name="{{tem.key}}" ng-model="dauConMum" ng-required="tem.required && !tem.relationship">-->

          <!--&lt;!&ndash;If no relationship is set&ndash;&gt;-->
          <!--&lt;!&ndash;<p ng-if="!tem.relationship">No relationships are set</p>&ndash;&gt;-->

          <!--<div ng-show="tem.relationship">-->
            <!--<div class="spacer" style="width: 283px; height: 15px;"></div>-->
            <!--<div class="col text-center">-->
              <!--<strong>{{tem.relationship[0] + " object(s) of type " + tem.relationship[1]}}</strong>-->
            <!--</div>-->
          <!--</div>-->

          <!--<div class="col text-center">-->
            <!--<button type="button" ng-click="addRelationship(tem)"-->
                    <!--class="button icon-left ion-fork-repo button-clear button-royal">{{(tem.relationship)? "Edit" :-->
              <!--"Add"}}-->
              <!--Relationship-->
            <!--</button>-->
          <!--</div>-->
        <!--</div>-->
      <!--</div>-->
    </form>
  </ion-content>

  <ion-footer-bar>
    <button type="button" ng-disabled="form.$invalid" ng-click="save()"
            class="button button-positive button-block no-side-margin">SAVE
    </button>
  </ion-footer-bar>
</ion-view>
